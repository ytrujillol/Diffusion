load "Element_P4"
// Parameters
int inside = 2; 
int outside = 1;
real d=0.1;
func f = 1.0; //RHS
real rate = 0; //Convergence rate

int n = 3, k = 2; // n = number of refinements, points = # of points in each borders
real[int] L2error(n), H1error(n);
real[int] Ntraingles(n), Msize(n);
real auxH1, auxL2, auxH1sol, auxL2sol;
string namefile;

//Solucion "Exacta"

//Mesh
border b1(t=0, 1){x=0; y=-t; label=outside;};
border b2(t=0, 1){x=t; y=-1;label=outside;};
border b3(t=0, 1){x=1; y=t-1;label=outside;};
border b4(t=0, 1){x=1; y=t;label=outside;};
border b5(t=0, 1){x=-t+1; y=1;label=outside;};
border b6(t=0, 1){x=0; y=-t+1;label=outside;};

border b7(t=0, 1){x= 0 + 0.012345679012345678 *t ; y= 0 + 0.0 *t;label=inside;};
border b8(t=0, 1){x= 0.012345679012345678 + 0.006172839506172839 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b9(t=0, 1){x= 0.018518518518518517 + 0.006172839506172839 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b10(t=0, 1){x= 0.024691358024691357 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b11(t=0, 1){x= 0.037037037037037035 + 0.006172839506172839 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b12(t=0, 1){x= 0.043209876543209874 + -0.006172839506172839 *t ; y= 0.010691671651659735 + 0.010691671651659735 *t;label=inside;};
border b13(t=0, 1){x= 0.037037037037037035 + 0.012345679012345678 *t ; y= 0.02138334330331947 + 3.469446951953614e-18 *t;label=inside;};
border b14(t=0, 1){x= 0.04938271604938271 + 0.006172839506172839 *t ; y= 0.021383343303319473 + 0.010691671651659733 *t;label=inside;};
border b15(t=0, 1){x= 0.05555555555555555 + 0.006172839506172839 *t ; y= 0.032075014954979206 + -0.010691671651659733 *t;label=inside;};
border b16(t=0, 1){x= 0.06172839506172839 + 0.012345679012345678 *t ; y= 0.021383343303319473 + -3.469446951953614e-18 *t;label=inside;};
border b17(t=0, 1){x= 0.07407407407407407 + -0.006172839506172839 *t ; y= 0.02138334330331947 + -0.010691671651659735 *t;label=inside;};
border b18(t=0, 1){x= 0.06790123456790123 + 0.006172839506172839 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b19(t=0, 1){x= 0.07407407407407407 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b20(t=0, 1){x= 0.08641975308641975 + 0.006172839506172839 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b21(t=0, 1){x= 0.09259259259259259 + 0.006172839506172839 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b22(t=0, 1){x= 0.09876543209876543 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b23(t=0, 1){x= 0.1111111111111111 + 0.006172839506172839 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b24(t=0, 1){x= 0.11728395061728394 + -0.006172839506172839 *t ; y= 0.010691671651659735 + 0.010691671651659735 *t;label=inside;};
border b25(t=0, 1){x= 0.1111111111111111 + 0.012345679012345678 *t ; y= 0.02138334330331947 + 3.469446951953614e-18 *t;label=inside;};
border b26(t=0, 1){x= 0.12345679012345678 + 0.006172839506172839 *t ; y= 0.021383343303319473 + 0.010691671651659733 *t;label=inside;};
border b27(t=0, 1){x= 0.12962962962962962 + -0.006172839506172839 *t ; y= 0.032075014954979206 + 0.010691671651659747 *t;label=inside;};
border b28(t=0, 1){x= 0.12345679012345678 + -0.012345679012345678 *t ; y= 0.04276668660663895 + 1.3877787807814457e-17 *t;label=inside;};
border b29(t=0, 1){x= 0.1111111111111111 + 0.006172839506172853 *t ; y= 0.042766686606638966 + 0.010691671651659726 *t;label=inside;};
border b30(t=0, 1){x= 0.11728395061728396 + -0.006172839506172839 *t ; y= 0.05345835825829869 + 0.010691671651659747 *t;label=inside;};
border b31(t=0, 1){x= 0.11111111111111112 + 0.012345679012345678 *t ; y= 0.06415002990995844 + -1.3877787807814457e-17 *t;label=inside;};
border b32(t=0, 1){x= 0.1234567901234568 + 0.006172839506172853 *t ; y= 0.06415002990995843 + 0.010691671651659754 *t;label=inside;};
border b33(t=0, 1){x= 0.12962962962962965 + 0.006172839506172839 *t ; y= 0.07484170156161818 + -0.010691671651659754 *t;label=inside;};
border b34(t=0, 1){x= 0.1358024691358025 + 0.012345679012345678 *t ; y= 0.06415002990995843 + -1.3877787807814457e-17 *t;label=inside;};
border b35(t=0, 1){x= 0.14814814814814817 + 0.006172839506172839 *t ; y= 0.06415002990995841 + 0.01069167165165974 *t;label=inside;};
border b36(t=0, 1){x= 0.154320987654321 + -0.006172839506172839 *t ; y= 0.07484170156161815 + 0.010691671651659726 *t;label=inside;};
border b37(t=0, 1){x= 0.14814814814814817 + 0.012345679012345678 *t ; y= 0.08553337321327788 + 0.0 *t;label=inside;};
border b38(t=0, 1){x= 0.16049382716049385 + 0.006172839506172839 *t ; y= 0.08553337321327788 + 0.01069167165165974 *t;label=inside;};
border b39(t=0, 1){x= 0.16666666666666669 + 0.006172839506172839 *t ; y= 0.09622504486493762 + -0.01069167165165974 *t;label=inside;};
border b40(t=0, 1){x= 0.17283950617283952 + 0.012345679012345678 *t ; y= 0.08553337321327788 + 0.0 *t;label=inside;};
border b41(t=0, 1){x= 0.1851851851851852 + -0.006172839506172839 *t ; y= 0.08553337321327788 + -0.010691671651659726 *t;label=inside;};
border b42(t=0, 1){x= 0.17901234567901236 + 0.006172839506172839 *t ; y= 0.07484170156161815 + -0.01069167165165974 *t;label=inside;};
border b43(t=0, 1){x= 0.1851851851851852 + 0.012345679012345678 *t ; y= 0.06415002990995841 + -1.3877787807814457e-17 *t;label=inside;};
border b44(t=0, 1){x= 0.19753086419753088 + 0.006172839506172839 *t ; y= 0.0641500299099584 + 0.010691671651659712 *t;label=inside;};
border b45(t=0, 1){x= 0.20370370370370372 + 0.006172839506172811 *t ; y= 0.07484170156161811 + -0.010691671651659712 *t;label=inside;};
border b46(t=0, 1){x= 0.20987654320987653 + 0.012345679012345678 *t ; y= 0.0641500299099584 + -1.3877787807814457e-17 *t;label=inside;};
border b47(t=0, 1){x= 0.2222222222222222 + -0.006172839506172839 *t ; y= 0.06415002990995838 + -0.010691671651659726 *t;label=inside;};
border b48(t=0, 1){x= 0.21604938271604937 + 0.006172839506172839 *t ; y= 0.05345835825829866 + -0.010691671651659733 *t;label=inside;};
border b49(t=0, 1){x= 0.2222222222222222 + -0.012345679012345678 *t ; y= 0.042766686606638925 + 6.938893903907228e-18 *t;label=inside;};
border b50(t=0, 1){x= 0.20987654320987653 + -0.006172839506172839 *t ; y= 0.04276668660663893 + -0.010691671651659726 *t;label=inside;};
border b51(t=0, 1){x= 0.2037037037037037 + 0.006172839506172839 *t ; y= 0.032075014954979206 + -0.010691671651659733 *t;label=inside;};
border b52(t=0, 1){x= 0.20987654320987653 + 0.012345679012345678 *t ; y= 0.021383343303319473 + -3.469446951953614e-18 *t;label=inside;};
border b53(t=0, 1){x= 0.2222222222222222 + -0.006172839506172839 *t ; y= 0.02138334330331947 + -0.010691671651659735 *t;label=inside;};
border b54(t=0, 1){x= 0.21604938271604937 + 0.006172839506172839 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b55(t=0, 1){x= 0.2222222222222222 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b56(t=0, 1){x= 0.2345679012345679 + 0.006172839506172839 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b57(t=0, 1){x= 0.24074074074074073 + 0.006172839506172839 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b58(t=0, 1){x= 0.24691358024691357 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b59(t=0, 1){x= 0.25925925925925924 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b60(t=0, 1){x= 0.2654320987654321 + -0.006172839506172867 *t ; y= 0.010691671651659735 + 0.010691671651659714 *t;label=inside;};
border b61(t=0, 1){x= 0.25925925925925924 + 0.012345679012345678 *t ; y= 0.02138334330331945 + 2.42861286636753e-17 *t;label=inside;};
border b62(t=0, 1){x= 0.2716049382716049 + 0.006172839506172867 *t ; y= 0.021383343303319473 + 0.010691671651659733 *t;label=inside;};
border b63(t=0, 1){x= 0.2777777777777778 + 0.006172839506172811 *t ; y= 0.032075014954979206 + -0.010691671651659733 *t;label=inside;};
border b64(t=0, 1){x= 0.2839506172839506 + 0.012345679012345678 *t ; y= 0.021383343303319473 + 2.0816681711721685e-17 *t;label=inside;};
border b65(t=0, 1){x= 0.2962962962962963 + -0.006172839506172811 *t ; y= 0.021383343303319494 + -0.010691671651659759 *t;label=inside;};
border b66(t=0, 1){x= 0.29012345679012347 + 0.006172839506172811 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b67(t=0, 1){x= 0.2962962962962963 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b68(t=0, 1){x= 0.30864197530864196 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659735 *t;label=inside;};
border b69(t=0, 1){x= 0.3148148148148148 + 0.006172839506172811 *t ; y= 0.010691671651659735 + -0.010691671651659735 *t;label=inside;};
border b70(t=0, 1){x= 0.32098765432098764 + 0.012345679012345678 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b71(t=0, 1){x= 0.3333333333333333 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659738 *t;label=inside;};
border b72(t=0, 1){x= 0.3395061728395062 + -0.006172839506172867 *t ; y= 0.010691671651659738 + 0.01069167165165971 *t;label=inside;};
border b73(t=0, 1){x= 0.3333333333333333 + 0.012345679012345678 *t ; y= 0.02138334330331945 + 2.42861286636753e-17 *t;label=inside;};
border b74(t=0, 1){x= 0.345679012345679 + 0.006172839506172867 *t ; y= 0.021383343303319473 + 0.01069167165165974 *t;label=inside;};
border b75(t=0, 1){x= 0.35185185185185186 + -0.006172839506172867 *t ; y= 0.03207501495497921 + 0.010691671651659733 *t;label=inside;};
border b76(t=0, 1){x= 0.345679012345679 + -0.012345679012345678 *t ; y= 0.042766686606638946 + 2.0816681711721685e-17 *t;label=inside;};
border b77(t=0, 1){x= 0.3333333333333333 + 0.006172839506172867 *t ; y= 0.042766686606638966 + 0.010691671651659712 *t;label=inside;};
border b78(t=0, 1){x= 0.3395061728395062 + -0.006172839506172867 *t ; y= 0.05345835825829868 + 0.010691671651659733 *t;label=inside;};
border b79(t=0, 1){x= 0.3333333333333333 + 0.012345679012345678 *t ; y= 0.06415002990995841 + 1.3877787807814457e-17 *t;label=inside;};
border b80(t=0, 1){x= 0.345679012345679 + 0.006172839506172867 *t ; y= 0.06415002990995843 + 0.01069167165165974 *t;label=inside;};
border b81(t=0, 1){x= 0.35185185185185186 + 0.006172839506172811 *t ; y= 0.07484170156161817 + -0.01069167165165974 *t;label=inside;};
border b82(t=0, 1){x= 0.35802469135802467 + 0.012345679012345678 *t ; y= 0.06415002990995843 + 1.3877787807814457e-17 *t;label=inside;};
border b83(t=0, 1){x= 0.37037037037037035 + 0.006172839506172867 *t ; y= 0.06415002990995844 + 0.01069167165165974 *t;label=inside;};
border b84(t=0, 1){x= 0.3765432098765432 + -0.006172839506172867 *t ; y= 0.07484170156161818 + 0.010691671651659712 *t;label=inside;};
border b85(t=0, 1){x= 0.37037037037037035 + 0.012345679012345678 *t ; y= 0.08553337321327789 + 1.3877787807814457e-17 *t;label=inside;};
border b86(t=0, 1){x= 0.38271604938271603 + 0.006172839506172867 *t ; y= 0.0855333732132779 + 0.01069167165165974 *t;label=inside;};
border b87(t=0, 1){x= 0.3888888888888889 + -0.006172839506172867 *t ; y= 0.09622504486493764 + 0.01069167165165974 *t;label=inside;};
border b88(t=0, 1){x= 0.38271604938271603 + -0.012345679012345678 *t ; y= 0.10691671651659738 + 2.7755575615628914e-17 *t;label=inside;};
border b89(t=0, 1){x= 0.37037037037037035 + 0.006172839506172867 *t ; y= 0.10691671651659741 + 0.010691671651659698 *t;label=inside;};
border b90(t=0, 1){x= 0.3765432098765432 + -0.006172839506172867 *t ; y= 0.11760838816825711 + 0.01069167165165974 *t;label=inside;};
border b91(t=0, 1){x= 0.37037037037037035 + -0.012345679012345678 *t ; y= 0.12830005981991685 + 0.0 *t;label=inside;};
border b92(t=0, 1){x= 0.35802469135802467 + -0.006172839506172811 *t ; y= 0.12830005981991685 + -0.010691671651659684 *t;label=inside;};
border b93(t=0, 1){x= 0.35185185185185186 + -0.006172839506172811 *t ; y= 0.11760838816825717 + 0.010691671651659684 *t;label=inside;};
border b94(t=0, 1){x= 0.34567901234567905 + -0.012345679012345678 *t ; y= 0.12830005981991685 + 0.0 *t;label=inside;};
border b95(t=0, 1){x= 0.33333333333333337 + 0.006172839506172811 *t ; y= 0.12830005981991685 + 0.01069167165165974 *t;label=inside;};
border b96(t=0, 1){x= 0.3395061728395062 + -0.006172839506172811 *t ; y= 0.1389917314715766 + 0.01069167165165974 *t;label=inside;};
border b97(t=0, 1){x= 0.33333333333333337 + 0.012345679012345678 *t ; y= 0.14968340312323633 + -2.7755575615628914e-17 *t;label=inside;};
border b98(t=0, 1){x= 0.34567901234567905 + 0.006172839506172811 *t ; y= 0.1496834031232363 + 0.01069167165165974 *t;label=inside;};
border b99(t=0, 1){x= 0.35185185185185186 + -0.006172839506172867 *t ; y= 0.16037507477489604 + 0.01069167165165974 *t;label=inside;};
border b100(t=0, 1){x= 0.345679012345679 + -0.012345679012345623 *t ; y= 0.17106674642655578 + 0.0 *t;label=inside;};
border b101(t=0, 1){x= 0.33333333333333337 + 0.006172839506172811 *t ; y= 0.17106674642655578 + 0.010691671651659712 *t;label=inside;};
border b102(t=0, 1){x= 0.3395061728395062 + -0.006172839506172867 *t ; y= 0.1817584180782155 + 0.01069167165165974 *t;label=inside;};
border b103(t=0, 1){x= 0.3333333333333333 + 0.012345679012345678 *t ; y= 0.19245008972987523 + 0.0 *t;label=inside;};
border b104(t=0, 1){x= 0.345679012345679 + 0.006172839506172867 *t ; y= 0.19245008972987523 + 0.01069167165165974 *t;label=inside;};
border b105(t=0, 1){x= 0.35185185185185186 + 0.006172839506172811 *t ; y= 0.20314176138153497 + -0.01069167165165974 *t;label=inside;};
border b106(t=0, 1){x= 0.35802469135802467 + 0.012345679012345678 *t ; y= 0.19245008972987523 + 0.0 *t;label=inside;};
border b107(t=0, 1){x= 0.37037037037037035 + 0.006172839506172811 *t ; y= 0.19245008972987523 + 0.01069167165165974 *t;label=inside;};
border b108(t=0, 1){x= 0.37654320987654316 + -0.006172839506172811 *t ; y= 0.20314176138153497 + 0.010691671651659768 *t;label=inside;};
border b109(t=0, 1){x= 0.37037037037037035 + 0.012345679012345678 *t ; y= 0.21383343303319474 + -2.7755575615628914e-17 *t;label=inside;};
border b110(t=0, 1){x= 0.38271604938271603 + 0.006172839506172811 *t ; y= 0.21383343303319471 + 0.01069167165165974 *t;label=inside;};
border b111(t=0, 1){x= 0.38888888888888884 + 0.006172839506172867 *t ; y= 0.22452510468485445 + -0.01069167165165974 *t;label=inside;};
border b112(t=0, 1){x= 0.3950617283950617 + 0.012345679012345623 *t ; y= 0.21383343303319471 + 0.0 *t;label=inside;};
border b113(t=0, 1){x= 0.40740740740740733 + -0.006172839506172811 *t ; y= 0.21383343303319471 + -0.010691671651659712 *t;label=inside;};
border b114(t=0, 1){x= 0.4012345679012345 + 0.006172839506172867 *t ; y= 0.203141761381535 + -0.01069167165165974 *t;label=inside;};
border b115(t=0, 1){x= 0.4074074074074074 + 0.012345679012345678 *t ; y= 0.19245008972987526 + 0.0 *t;label=inside;};
border b116(t=0, 1){x= 0.41975308641975306 + 0.006172839506172867 *t ; y= 0.19245008972987526 + 0.01069167165165974 *t;label=inside;};
border b117(t=0, 1){x= 0.42592592592592593 + 0.006172839506172811 *t ; y= 0.203141761381535 + -0.01069167165165974 *t;label=inside;};
border b118(t=0, 1){x= 0.43209876543209874 + 0.012345679012345678 *t ; y= 0.19245008972987526 + 0.0 *t;label=inside;};
border b119(t=0, 1){x= 0.4444444444444444 + 0.006172839506172867 *t ; y= 0.19245008972987526 + 0.01069167165165974 *t;label=inside;};
border b120(t=0, 1){x= 0.4506172839506173 + -0.006172839506172867 *t ; y= 0.203141761381535 + 0.010691671651659712 *t;label=inside;};
border b121(t=0, 1){x= 0.4444444444444444 + 0.012345679012345678 *t ; y= 0.21383343303319471 + 2.7755575615628914e-17 *t;label=inside;};
border b122(t=0, 1){x= 0.4567901234567901 + 0.006172839506172867 *t ; y= 0.21383343303319474 + 0.01069167165165974 *t;label=inside;};
border b123(t=0, 1){x= 0.46296296296296297 + -0.006172839506172867 *t ; y= 0.22452510468485448 + 0.010691671651659712 *t;label=inside;};
border b124(t=0, 1){x= 0.4567901234567901 + -0.012345679012345678 *t ; y= 0.2352167763365142 + 2.7755575615628914e-17 *t;label=inside;};
border b125(t=0, 1){x= 0.4444444444444444 + 0.006172839506172867 *t ; y= 0.23521677633651422 + 0.010691671651659712 *t;label=inside;};
border b126(t=0, 1){x= 0.4506172839506173 + -0.006172839506172867 *t ; y= 0.24590844798817393 + 0.010691671651659712 *t;label=inside;};
border b127(t=0, 1){x= 0.4444444444444444 + 0.012345679012345678 *t ; y= 0.25660011963983365 + 0.0 *t;label=inside;};
border b128(t=0, 1){x= 0.4567901234567901 + 0.006172839506172811 *t ; y= 0.25660011963983365 + 0.01069167165165974 *t;label=inside;};
border b129(t=0, 1){x= 0.4629629629629629 + 0.006172839506172867 *t ; y= 0.2672917912914934 + -0.010691671651659684 *t;label=inside;};
border b130(t=0, 1){x= 0.4691358024691358 + 0.012345679012345678 *t ; y= 0.2566001196398337 + 0.0 *t;label=inside;};
border b131(t=0, 1){x= 0.48148148148148145 + 0.006172839506172867 *t ; y= 0.2566001196398337 + 0.01069167165165974 *t;label=inside;};
border b132(t=0, 1){x= 0.4876543209876543 + -0.006172839506172867 *t ; y= 0.26729179129149344 + 0.01069167165165974 *t;label=inside;};
border b133(t=0, 1){x= 0.48148148148148145 + 0.012345679012345678 *t ; y= 0.2779834629431532 + 0.0 *t;label=inside;};
border b134(t=0, 1){x= 0.49382716049382713 + 0.006172839506172867 *t ; y= 0.2779834629431532 + 0.01069167165165974 *t;label=inside;};
border b135(t=0, 1){x= 0.5 + 0.006172839506172867 *t ; y= 0.2886751345948129 + -0.01069167165165974 *t;label=inside;};
border b136(t=0, 1){x= 0.5061728395061729 + 0.012345679012345623 *t ; y= 0.2779834629431532 + -5.551115123125783e-17 *t;label=inside;};
border b137(t=0, 1){x= 0.5185185185185185 + -0.006172839506172867 *t ; y= 0.2779834629431531 + -0.010691671651659684 *t;label=inside;};
border b138(t=0, 1){x= 0.5123456790123456 + 0.006172839506172867 *t ; y= 0.26729179129149344 + -0.01069167165165974 *t;label=inside;};
border b139(t=0, 1){x= 0.5185185185185185 + 0.012345679012345734 *t ; y= 0.2566001196398337 + 0.0 *t;label=inside;};
border b140(t=0, 1){x= 0.5308641975308642 + 0.006172839506172756 *t ; y= 0.2566001196398337 + 0.01069167165165974 *t;label=inside;};
border b141(t=0, 1){x= 0.537037037037037 + 0.006172839506172867 *t ; y= 0.26729179129149344 + -0.010691671651659684 *t;label=inside;};
border b142(t=0, 1){x= 0.5432098765432098 + 0.012345679012345734 *t ; y= 0.25660011963983376 + 0.0 *t;label=inside;};
border b143(t=0, 1){x= 0.5555555555555556 + -0.006172839506172867 *t ; y= 0.25660011963983376 + -0.010691671651659768 *t;label=inside;};
border b144(t=0, 1){x= 0.5493827160493827 + 0.006172839506172867 *t ; y= 0.245908447988174 + -0.010691671651659657 *t;label=inside;};
border b145(t=0, 1){x= 0.5555555555555556 + -0.012345679012345623 *t ; y= 0.23521677633651433 + -8.326672684688674e-17 *t;label=inside;};
border b146(t=0, 1){x= 0.54320987654321 + -0.006172839506172867 *t ; y= 0.23521677633651425 + -0.010691671651659768 *t;label=inside;};
border b147(t=0, 1){x= 0.5370370370370371 + 0.006172839506172867 *t ; y= 0.22452510468485448 + -0.01069167165165974 *t;label=inside;};
border b148(t=0, 1){x= 0.54320987654321 + 0.012345679012345623 *t ; y= 0.21383343303319474 + -8.326672684688674e-17 *t;label=inside;};
border b149(t=0, 1){x= 0.5555555555555556 + -0.006172839506172867 *t ; y= 0.21383343303319466 + -0.010691671651659657 *t;label=inside;};
border b150(t=0, 1){x= 0.5493827160493827 + 0.006172839506172867 *t ; y= 0.203141761381535 + -0.01069167165165974 *t;label=inside;};
border b151(t=0, 1){x= 0.5555555555555556 + 0.012345679012345734 *t ; y= 0.19245008972987526 + 0.0 *t;label=inside;};
border b152(t=0, 1){x= 0.5679012345679013 + 0.006172839506172867 *t ; y= 0.19245008972987526 + 0.010691671651659684 *t;label=inside;};
border b153(t=0, 1){x= 0.5740740740740742 + 0.006172839506172756 *t ; y= 0.20314176138153495 + -0.010691671651659684 *t;label=inside;};
border b154(t=0, 1){x= 0.5802469135802469 + 0.012345679012345734 *t ; y= 0.19245008972987526 + 0.0 *t;label=inside;};
border b155(t=0, 1){x= 0.5925925925925927 + 0.006172839506172867 *t ; y= 0.19245008972987526 + 0.010691671651659712 *t;label=inside;};
border b156(t=0, 1){x= 0.5987654320987655 + -0.006172839506172867 *t ; y= 0.20314176138153497 + 0.010691671651659657 *t;label=inside;};
border b157(t=0, 1){x= 0.5925925925925927 + 0.012345679012345623 *t ; y= 0.21383343303319463 + 8.326672684688674e-17 *t;label=inside;};
border b158(t=0, 1){x= 0.6049382716049383 + 0.006172839506172867 *t ; y= 0.21383343303319471 + 0.010691671651659712 *t;label=inside;};
border b159(t=0, 1){x= 0.6111111111111112 + 0.006172839506172867 *t ; y= 0.22452510468485443 + -0.010691671651659712 *t;label=inside;};
border b160(t=0, 1){x= 0.617283950617284 + 0.012345679012345623 *t ; y= 0.21383343303319471 + -5.551115123125783e-17 *t;label=inside;};
border b161(t=0, 1){x= 0.6296296296296297 + -0.006172839506172867 *t ; y= 0.21383343303319466 + -0.010691671651659657 *t;label=inside;};
border b162(t=0, 1){x= 0.6234567901234568 + 0.006172839506172867 *t ; y= 0.203141761381535 + -0.010691671651659712 *t;label=inside;};
border b163(t=0, 1){x= 0.6296296296296297 + 0.012345679012345734 *t ; y= 0.1924500897298753 + 0.0 *t;label=inside;};
border b164(t=0, 1){x= 0.6419753086419754 + 0.006172839506172867 *t ; y= 0.1924500897298753 + 0.010691671651659684 *t;label=inside;};
border b165(t=0, 1){x= 0.6481481481481483 + 0.006172839506172756 *t ; y= 0.20314176138153497 + -0.010691671651659684 *t;label=inside;};
border b166(t=0, 1){x= 0.654320987654321 + 0.012345679012345734 *t ; y= 0.1924500897298753 + 0.0 *t;label=inside;};
border b167(t=0, 1){x= 0.6666666666666667 + -0.006172839506172867 *t ; y= 0.1924500897298753 + -0.01069167165165974 *t;label=inside;};
border b168(t=0, 1){x= 0.6604938271604939 + 0.006172839506172867 *t ; y= 0.18175841807821555 + -0.010691671651659657 *t;label=inside;};
border b169(t=0, 1){x= 0.6666666666666667 + -0.012345679012345623 *t ; y= 0.1710667464265559 + -8.326672684688674e-17 *t;label=inside;};
border b170(t=0, 1){x= 0.6543209876543211 + -0.006172839506172867 *t ; y= 0.1710667464265558 + -0.01069167165165974 *t;label=inside;};
border b171(t=0, 1){x= 0.6481481481481483 + 0.006172839506172867 *t ; y= 0.16037507477489607 + -0.010691671651659768 *t;label=inside;};
border b172(t=0, 1){x= 0.6543209876543211 + 0.012345679012345623 *t ; y= 0.1496834031232363 + -8.326672684688674e-17 *t;label=inside;};
border b173(t=0, 1){x= 0.6666666666666667 + -0.006172839506172867 *t ; y= 0.14968340312323622 + -0.010691671651659684 *t;label=inside;};
border b174(t=0, 1){x= 0.6604938271604939 + 0.006172839506172867 *t ; y= 0.13899173147157654 + -0.010691671651659768 *t;label=inside;};
border b175(t=0, 1){x= 0.6666666666666667 + -0.012345679012345734 *t ; y= 0.12830005981991677 + 2.7755575615628914e-17 *t;label=inside;};
border b176(t=0, 1){x= 0.654320987654321 + -0.006172839506172867 *t ; y= 0.1283000598199168 + -0.01069167165165967 *t;label=inside;};
border b177(t=0, 1){x= 0.6481481481481481 + -0.006172839506172756 *t ; y= 0.11760838816825712 + 0.010691671651659698 *t;label=inside;};
border b178(t=0, 1){x= 0.6419753086419754 + -0.012345679012345734 *t ; y= 0.12830005981991682 + 2.7755575615628914e-17 *t;label=inside;};
border b179(t=0, 1){x= 0.6296296296296297 + -0.006172839506172867 *t ; y= 0.12830005981991685 + -0.01069167165165974 *t;label=inside;};
border b180(t=0, 1){x= 0.6234567901234568 + 0.006172839506172867 *t ; y= 0.11760838816825711 + -0.010691671651659657 *t;label=inside;};
border b181(t=0, 1){x= 0.6296296296296297 + -0.012345679012345623 *t ; y= 0.10691671651659745 + -6.938893903907228e-17 *t;label=inside;};
border b182(t=0, 1){x= 0.617283950617284 + -0.006172839506172867 *t ; y= 0.10691671651659738 + -0.01069167165165974 *t;label=inside;};
border b183(t=0, 1){x= 0.6111111111111112 + 0.006172839506172867 *t ; y= 0.09622504486493764 + -0.01069167165165974 *t;label=inside;};
border b184(t=0, 1){x= 0.617283950617284 + 0.012345679012345623 *t ; y= 0.0855333732132779 + -6.938893903907228e-17 *t;label=inside;};
border b185(t=0, 1){x= 0.6296296296296297 + -0.006172839506172867 *t ; y= 0.08553337321327784 + -0.010691671651659657 *t;label=inside;};
border b186(t=0, 1){x= 0.6234567901234568 + 0.006172839506172867 *t ; y= 0.07484170156161818 + -0.01069167165165974 *t;label=inside;};
border b187(t=0, 1){x= 0.6296296296296297 + 0.012345679012345734 *t ; y= 0.06415002990995844 + 1.3877787807814457e-17 *t;label=inside;};
border b188(t=0, 1){x= 0.6419753086419754 + 0.006172839506172756 *t ; y= 0.06415002990995845 + 0.010691671651659698 *t;label=inside;};
border b189(t=0, 1){x= 0.6481481481481481 + 0.006172839506172867 *t ; y= 0.07484170156161815 + -0.01069167165165967 *t;label=inside;};
border b190(t=0, 1){x= 0.654320987654321 + 0.012345679012345734 *t ; y= 0.06415002990995848 + 1.3877787807814457e-17 *t;label=inside;};
border b191(t=0, 1){x= 0.6666666666666667 + -0.006172839506172867 *t ; y= 0.0641500299099585 + -0.01069167165165976 *t;label=inside;};
border b192(t=0, 1){x= 0.6604938271604939 + 0.006172839506172867 *t ; y= 0.053458358258298734 + -0.010691671651659677 *t;label=inside;};
border b193(t=0, 1){x= 0.6666666666666667 + -0.012345679012345623 *t ; y= 0.04276668660663906 + -8.326672684688674e-17 *t;label=inside;};
border b194(t=0, 1){x= 0.6543209876543211 + -0.006172839506172867 *t ; y= 0.04276668660663897 + -0.01069167165165976 *t;label=inside;};
border b195(t=0, 1){x= 0.6481481481481483 + 0.006172839506172867 *t ; y= 0.03207501495497921 + -0.01069167165165974 *t;label=inside;};
border b196(t=0, 1){x= 0.6543209876543211 + 0.012345679012345623 *t ; y= 0.021383343303319473 + -7.28583859910259e-17 *t;label=inside;};
border b197(t=0, 1){x= 0.6666666666666667 + -0.006172839506172867 *t ; y= 0.0213833433033194 + -0.010691671651659662 *t;label=inside;};
border b198(t=0, 1){x= 0.6604938271604939 + 0.006172839506172867 *t ; y= 0.010691671651659738 + -0.010691671651659738 *t;label=inside;};
border b199(t=0, 1){x= 0.6666666666666667 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b200(t=0, 1){x= 0.6790123456790124 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659783 *t;label=inside;};
border b201(t=0, 1){x= 0.6851851851851852 + 0.006172839506172867 *t ; y= 0.010691671651659783 + -0.010691671651659783 *t;label=inside;};
border b202(t=0, 1){x= 0.6913580246913581 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b203(t=0, 1){x= 0.7037037037037037 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659752 *t;label=inside;};
border b204(t=0, 1){x= 0.7098765432098766 + -0.006172839506172867 *t ; y= 0.010691671651659752 + 0.010691671651659766 *t;label=inside;};
border b205(t=0, 1){x= 0.7037037037037037 + 0.012345679012345734 *t ; y= 0.021383343303319518 + -1.734723475976807e-17 *t;label=inside;};
border b206(t=0, 1){x= 0.7160493827160495 + 0.006172839506172867 *t ; y= 0.0213833433033195 + 0.010691671651659754 *t;label=inside;};
border b207(t=0, 1){x= 0.7222222222222223 + 0.006172839506172867 *t ; y= 0.032075014954979254 + -0.010691671651659754 *t;label=inside;};
border b208(t=0, 1){x= 0.7283950617283952 + 0.012345679012345623 *t ; y= 0.0213833433033195 + -7.979727989493313e-17 *t;label=inside;};
border b209(t=0, 1){x= 0.7407407407407408 + -0.006172839506172867 *t ; y= 0.02138334330331942 + -0.010691671651659669 *t;label=inside;};
border b210(t=0, 1){x= 0.7345679012345679 + 0.006172839506172867 *t ; y= 0.010691671651659752 + -0.010691671651659752 *t;label=inside;};
border b211(t=0, 1){x= 0.7407407407407408 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b212(t=0, 1){x= 0.7530864197530864 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659783 *t;label=inside;};
border b213(t=0, 1){x= 0.7592592592592593 + 0.006172839506172867 *t ; y= 0.010691671651659783 + -0.010691671651659783 *t;label=inside;};
border b214(t=0, 1){x= 0.7654320987654322 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b215(t=0, 1){x= 0.7777777777777778 + 0.006172839506172867 *t ; y= 0.0 + 0.01069167165165974 *t;label=inside;};
border b216(t=0, 1){x= 0.7839506172839507 + -0.006172839506172867 *t ; y= 0.01069167165165974 + 0.010691671651659664 *t;label=inside;};
border b217(t=0, 1){x= 0.7777777777777778 + 0.012345679012345623 *t ; y= 0.021383343303319403 + 7.632783294297951e-17 *t;label=inside;};
border b218(t=0, 1){x= 0.7901234567901234 + 0.006172839506172867 *t ; y= 0.02138334330331948 + 0.01069167165165974 *t;label=inside;};
border b219(t=0, 1){x= 0.7962962962962963 + -0.006172839506172867 *t ; y= 0.03207501495497922 + 0.01069167165165976 *t;label=inside;};
border b220(t=0, 1){x= 0.7901234567901234 + -0.012345679012345623 *t ; y= 0.04276668660663898 + 9.020562075079397e-17 *t;label=inside;};
border b221(t=0, 1){x= 0.7777777777777778 + 0.006172839506172867 *t ; y= 0.04276668660663907 + 0.010691671651659677 *t;label=inside;};
border b222(t=0, 1){x= 0.7839506172839507 + -0.006172839506172867 *t ; y= 0.05345835825829875 + 0.01069167165165976 *t;label=inside;};
border b223(t=0, 1){x= 0.7777777777777778 + 0.012345679012345734 *t ; y= 0.06415002990995851 + -2.7755575615628914e-17 *t;label=inside;};
border b224(t=0, 1){x= 0.7901234567901235 + 0.006172839506172867 *t ; y= 0.06415002990995848 + 0.010691671651659684 *t;label=inside;};
border b225(t=0, 1){x= 0.7962962962962964 + 0.006172839506172756 *t ; y= 0.07484170156161817 + -0.010691671651659698 *t;label=inside;};
border b226(t=0, 1){x= 0.8024691358024691 + 0.012345679012345734 *t ; y= 0.06415002990995847 + -2.7755575615628914e-17 *t;label=inside;};
border b227(t=0, 1){x= 0.8148148148148149 + 0.006172839506172867 *t ; y= 0.06415002990995844 + 0.01069167165165974 *t;label=inside;};
border b228(t=0, 1){x= 0.8209876543209877 + -0.006172839506172867 *t ; y= 0.07484170156161818 + 0.01069167165165967 *t;label=inside;};
border b229(t=0, 1){x= 0.8148148148148149 + 0.012345679012345623 *t ; y= 0.08553337321327785 + 6.938893903907228e-17 *t;label=inside;};
border b230(t=0, 1){x= 0.8271604938271605 + 0.006172839506172867 *t ; y= 0.08553337321327792 + 0.01069167165165974 *t;label=inside;};
border b231(t=0, 1){x= 0.8333333333333334 + 0.006172839506172867 *t ; y= 0.09622504486493766 + -0.01069167165165974 *t;label=inside;};
border b232(t=0, 1){x= 0.8395061728395062 + 0.012345679012345623 *t ; y= 0.08553337321327792 + -8.326672684688674e-17 *t;label=inside;};
border b233(t=0, 1){x= 0.8518518518518519 + -0.006172839506172867 *t ; y= 0.08553337321327784 + -0.010691671651659657 *t;label=inside;};
border b234(t=0, 1){x= 0.845679012345679 + 0.006172839506172867 *t ; y= 0.07484170156161818 + -0.01069167165165974 *t;label=inside;};
border b235(t=0, 1){x= 0.8518518518518519 + 0.012345679012345734 *t ; y= 0.06415002990995844 + 2.7755575615628914e-17 *t;label=inside;};
border b236(t=0, 1){x= 0.8641975308641976 + 0.006172839506172756 *t ; y= 0.06415002990995847 + 0.010691671651659698 *t;label=inside;};
border b237(t=0, 1){x= 0.8703703703703703 + 0.006172839506172867 *t ; y= 0.07484170156161817 + -0.010691671651659684 *t;label=inside;};
border b238(t=0, 1){x= 0.8765432098765432 + 0.012345679012345734 *t ; y= 0.06415002990995848 + 2.7755575615628914e-17 *t;label=inside;};
border b239(t=0, 1){x= 0.888888888888889 + -0.006172839506172867 *t ; y= 0.06415002990995851 + -0.01069167165165976 *t;label=inside;};
border b240(t=0, 1){x= 0.8827160493827161 + 0.006172839506172867 *t ; y= 0.05345835825829875 + -0.010691671651659677 *t;label=inside;};
border b241(t=0, 1){x= 0.888888888888889 + -0.012345679012345623 *t ; y= 0.04276668660663907 + -9.020562075079397e-17 *t;label=inside;};
border b242(t=0, 1){x= 0.8765432098765433 + -0.006172839506172867 *t ; y= 0.04276668660663898 + -0.01069167165165976 *t;label=inside;};
border b243(t=0, 1){x= 0.8703703703703705 + 0.006172839506172867 *t ; y= 0.03207501495497922 + -0.01069167165165974 *t;label=inside;};
border b244(t=0, 1){x= 0.8765432098765433 + 0.012345679012345623 *t ; y= 0.02138334330331948 + -7.632783294297951e-17 *t;label=inside;};
border b245(t=0, 1){x= 0.888888888888889 + -0.006172839506172867 *t ; y= 0.021383343303319403 + -0.010691671651659664 *t;label=inside;};
border b246(t=0, 1){x= 0.8827160493827161 + 0.006172839506172867 *t ; y= 0.01069167165165974 + -0.01069167165165974 *t;label=inside;};
border b247(t=0, 1){x= 0.888888888888889 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b248(t=0, 1){x= 0.9012345679012346 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659783 *t;label=inside;};
border b249(t=0, 1){x= 0.9074074074074074 + 0.006172839506172867 *t ; y= 0.010691671651659783 + -0.010691671651659783 *t;label=inside;};
border b250(t=0, 1){x= 0.9135802469135803 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b251(t=0, 1){x= 0.9259259259259259 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659752 *t;label=inside;};
border b252(t=0, 1){x= 0.9320987654320988 + -0.006172839506172867 *t ; y= 0.010691671651659752 + 0.010691671651659766 *t;label=inside;};
border b253(t=0, 1){x= 0.9259259259259259 + 0.012345679012345734 *t ; y= 0.021383343303319518 + -1.734723475976807e-17 *t;label=inside;};
border b254(t=0, 1){x= 0.9382716049382717 + 0.006172839506172867 *t ; y= 0.0213833433033195 + 0.010691671651659754 *t;label=inside;};
border b255(t=0, 1){x= 0.9444444444444445 + 0.006172839506172867 *t ; y= 0.032075014954979254 + -0.010691671651659754 *t;label=inside;};
border b256(t=0, 1){x= 0.9506172839506174 + 0.012345679012345623 *t ; y= 0.0213833433033195 + -7.979727989493313e-17 *t;label=inside;};
border b257(t=0, 1){x= 0.962962962962963 + -0.006172839506172867 *t ; y= 0.02138334330331942 + -0.010691671651659669 *t;label=inside;};
border b258(t=0, 1){x= 0.9567901234567902 + 0.006172839506172867 *t ; y= 0.010691671651659752 + -0.010691671651659752 *t;label=inside;};
border b259(t=0, 1){x= 0.962962962962963 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};
border b260(t=0, 1){x= 0.9753086419753086 + 0.006172839506172867 *t ; y= 0.0 + 0.010691671651659783 *t;label=inside;};
border b261(t=0, 1){x= 0.9814814814814815 + 0.006172839506172867 *t ; y= 0.010691671651659783 + -0.010691671651659783 *t;label=inside;};
border b262(t=0, 1){x= 0.9876543209876544 + 0.012345679012345623 *t ; y= 0.0 + 0.0 *t;label=inside;};

int m = 8;
mesh Th1 = buildmesh(b1(m) + b2(m) + b3(m) +  b4(m) + b5(m) + b6(m) +
b262(-m)+b261(-m)+b260(-m)+b259(-m)+b258(-m)+b257(-m)+b256(-m)+b255(-m)+b254(-m)+b253(-m)+b252(-m)+
b251(-m)+b250(-m)+b249(-m)+b248(-m)+b247(-m)+b246(-m)+b245(-m)+b244(-m)+b243(-m)+b242(-m)+b241(-m)+
b240(-m)+b239(-m)+b238(-m)+b237(-m)+b236(-m)+b235(-m)+b234(-m)+b233(-m)+b232(-m)+b231(-m)+b230(-m)+
b229(-m)+b228(-m)+b227(-m)+b226(-m)+b225(-m)+b224(-m)+b223(-m)+b222(-m)+b221(-m)+b220(-m)+b219(-m)+
b218(-m)+b217(-m)+b216(-m)+b215(-m)+b214(-m)+b213(-m)+b212(-m)+b211(-m)+b210(-m)+b209(-m)+b208(-m)+
b207(-m)+b206(-m)+b205(-m)+b204(-m)+b203(-m)+b202(-m)+b201(-m)+b200(-m)+b199(-m)+b198(-m)+b197(-m)+
b196(-m)+b195(-m)+b194(-m)+b193(-m)+b192(-m)+b191(-m)+b190(-m)+b189(-m)+b188(-m)+b187(-m)+b186(-m)+
b185(-m)+b184(-m)+b183(-m)+b182(-m)+b181(-m)+b180(-m)+b179(-m)+b178(-m)+b177(-m)+b176(-m)+b175(-m)+
b174(-m)+b173(-m)+b172(-m)+b171(-m)+b170(-m)+b169(-m)+b168(-m)+b167(-m)+b166(-m)+b165(-m)+b164(-m)+
b163(-m)+b162(-m)+b161(-m)+b160(-m)+b159(-m)+b158(-m)+b157(-m)+b156(-m)+b155(-m)+b154(-m)+b153(-m)+
b152(-m)+b151(-m)+b150(-m)+b149(-m)+b148(-m)+b147(-m)+b146(-m)+b145(-m)+b144(-m)+b143(-m)+b142(-m)+
b141(-m)+b140(-m)+b139(-m)+b138(-m)+b137(-m)+b136(-m)+b135(-m)+b134(-m)+b133(-m)+b132(-m)+b131(-m)+
b130(-m)+b129(-m)+b128(-m)+b127(-m)+b126(-m)+b125(-m)+b124(-m)+b123(-m)+b122(-m)+b121(-m)+b120(-m)+
b119(-m)+b118(-m)+b117(-m)+b116(-m)+b115(-m)+b114(-m)+b113(-m)+b112(-m)+b111(-m)+b110(-m)+b109(-m)+
b108(-m)+b107(-m)+b106(-m)+b105(-m)+b104(-m)+b103(-m)+b102(-m)+b101(-m)+b100(-m)+b99(-m)+b98(-m)+b97(-m)
+b96(-m)+b95(-m)+b94(-m)+b93(-m)+b92(-m)+b91(-m)+b90(-m)+b89(-m)+b88(-m)+b87(-m)+b86(-m)+b85(-m)+b84(-m)+
b83(-m)+b82(-m)+b81(-m)+b80(-m)+b79(-m)+b78(-m)+b77(-m)+b76(-m)+b75(-m)+b74(-m)+b73(-m)+b72(-m)+b71(-m)+
b70(-m)+b69(-m)+b68(-m)+b67(-m)+b66(-m)+b65(-m)+b64(-m)+b63(-m)+b62(-m)+b61(-m)+b60(-m)+
b59(-m)+b58(-m)+b57(-m)+b56(-m)+b55(-m)+b54(-m)+b53(-m)+b52(-m)+b51(-m)+b50(-m)+b49(-m)+
b48(-m)+b47(-m)+b46(-m)+b45(-m)+b44(-m)+b43(-m)+b42(-m)+b41(-m)+b40(-m)+b39(-m)+b38(-m)+
b37(-m)+b36(-m)+b35(-m)+b34(-m)+b33(-m)+b32(-m)+b31(-m)+b30(-m)+b29(-m)+b28(-m)+b27(-m)+
b26(-m)+b25(-m)+b24(-m)+b23(-m)+b22(-m)+b21(-m)+b20(-m)+b19(-m)+b18(-m)+b17(-m)+b16(-m)+
b15(-m)+b14(-m)+b13(-m)+b12(-m)+b11(-m)+b10(-m)+b9(-m)+b8(-m)+b7(-m));
//plot(Th1, wait=true);

// Fespace
fespace Vh1(Th1, P4);
Vh1 usol, v1, dxusol, dyusol;

solve smoothcrack(usol, v1)
  = int2d(Th1)(dx(usol)*dx(v1) + dy(usol)*dy(v1))
  +int1d(Th1,inside)(-d*N.y*dx(usol)*dx(v1)+d*N.x*dy(usol)*dy(v1)) - int2d(Th1)(f*v1) + on(outside,usol=0);
//plot(usol, value=true, fill=true, wait=true);

dxusol=dx(usol);
dyusol=dy(usol);

mesh Th = buildmesh(b1(k) + b2(k) + b3(k) +  b4(k) + b5(k) + b6(k) +
b262(-k)+b261(-k)+b260(-k)+b259(-k)+b258(-k)+b257(-k)+b256(-k)+b255(-k)+b254(-k)+b253(-k)+b252(-k)+
b251(-k)+b250(-k)+b249(-k)+b248(-k)+b247(-k)+b246(-k)+b245(-k)+b244(-k)+b243(-k)+b242(-k)+b241(-k)+
b240(-k)+b239(-k)+b238(-k)+b237(-k)+b236(-k)+b235(-k)+b234(-k)+b233(-k)+b232(-k)+b231(-k)+b230(-k)+
b229(-k)+b228(-k)+b227(-k)+b226(-k)+b225(-k)+b224(-k)+b223(-k)+b222(-k)+b221(-k)+b220(-k)+b219(-k)+
b218(-k)+b217(-k)+b216(-k)+b215(-k)+b214(-k)+b213(-k)+b212(-k)+b211(-k)+b210(-k)+b209(-k)+b208(-k)+
b207(-k)+b206(-k)+b205(-k)+b204(-k)+b203(-k)+b202(-k)+b201(-k)+b200(-k)+b199(-k)+b198(-k)+b197(-k)+
b196(-k)+b195(-k)+b194(-k)+b193(-k)+b192(-k)+b191(-k)+b190(-k)+b189(-k)+b188(-k)+b187(-k)+b186(-k)+
b185(-k)+b184(-k)+b183(-k)+b182(-k)+b181(-k)+b180(-k)+b179(-k)+b178(-k)+b177(-k)+b176(-k)+b175(-k)+
b174(-k)+b173(-k)+b172(-k)+b171(-k)+b170(-k)+b169(-k)+b168(-k)+b167(-k)+b166(-k)+b165(-k)+b164(-k)+
b163(-k)+b162(-k)+b161(-k)+b160(-k)+b159(-k)+b158(-k)+b157(-k)+b156(-k)+b155(-k)+b154(-k)+b153(-k)+
b152(-k)+b151(-k)+b150(-k)+b149(-k)+b148(-k)+b147(-k)+b146(-k)+b145(-k)+b144(-k)+b143(-k)+b142(-k)+
b141(-k)+b140(-k)+b139(-k)+b138(-k)+b137(-k)+b136(-k)+b135(-k)+b134(-k)+b133(-k)+b132(-k)+b131(-k)+
b130(-k)+b129(-k)+b128(-k)+b127(-k)+b126(-k)+b125(-k)+b124(-k)+b123(-k)+b122(-k)+b121(-k)+b120(-k)+
b119(-k)+b118(-k)+b117(-k)+b116(-k)+b115(-k)+b114(-k)+b113(-k)+b112(-k)+b111(-k)+b110(-k)+b109(-k)+
b108(-k)+b107(-k)+b106(-k)+b105(-k)+b104(-k)+b103(-k)+b102(-k)+b101(-k)+b100(-k)+b99(-k)+b98(-k)+b97(-k)
+b96(-k)+b95(-k)+b94(-k)+b93(-k)+b92(-k)+b91(-k)+b90(-k)+b89(-k)+b88(-k)+b87(-k)+b86(-k)+b85(-k)+b84(-k)+
b83(-k)+b82(-k)+b81(-k)+b80(-k)+b79(-k)+b78(-k)+b77(-k)+b76(-k)+b75(-k)+b74(-k)+b73(-k)+b72(-k)+b71(-k)+
b70(-k)+b69(-k)+b68(-k)+b67(-k)+b66(-k)+b65(-k)+b64(-k)+b63(-k)+b62(-k)+b61(-k)+b60(-k)+
b59(-k)+b58(-k)+b57(-k)+b56(-k)+b55(-k)+b54(-k)+b53(-k)+b52(-k)+b51(-k)+b50(-k)+b49(-k)+
b48(-k)+b47(-k)+b46(-k)+b45(-k)+b44(-k)+b43(-k)+b42(-k)+b41(-k)+b40(-k)+b39(-k)+b38(-k)+
b37(-k)+b36(-k)+b35(-k)+b34(-k)+b33(-k)+b32(-k)+b31(-k)+b30(-k)+b29(-k)+b28(-k)+b27(-k)+
b26(-k)+b25(-k)+b24(-k)+b23(-k)+b22(-k)+b21(-k)+b20(-k)+b19(-k)+b18(-k)+b17(-k)+b16(-k)+
b15(-k)+b14(-k)+b13(-k)+b12(-k)+b11(-k)+b10(-k)+b9(-k)+b8(-k)+b7(-k));
// Loop for refinements
for(int i = 0; i < n; i++){
    // Fespace
    fespace Vh(Th, P1);
    Vh  h = hTriangle;
    Msize[i] = h[].max;
    Vh u,v;
    // Problem
    solve smoothcrack(u, v)
    = int2d(Th)(dx(u)*dx(v) + dy(u)*dy(v))
    +int1d(Th,inside)(-d*N.y*dx(u)*dx(v)+d*N.x*dy(u)*dy(v) ) - int2d(Th)(f*v) + on(outside,u=0);
    //plot(u, value=true, fill=true, wait=true);

    auxL2 = int2d(Th)((u - usol)^2);
    auxL2sol = int2d(Th)((usol)^2);
    auxH1 = int2d(Th)((dx(u) - dxusol)^2 + (dy(u) - dyusol)^2);
    auxH1sol = int2d(Th)((dxusol)^2 + (dyusol)^2);
    L2error[i] = sqrt(auxL2/auxL2sol);
    H1error[i] = sqrt(auxL2 + auxH1) / sqrt(auxL2sol + auxH1sol);
    Ntraingles[i] = Th.nt;
    cout << "L2Error\t" << L2error[i] << endl;
    Th = trunc(Th,1,split=2); //refine mesh
    //plot(Th, wait=true);
  }

  //to build a data file
  {
    namefile = "dataK4.txt";
    ofstream ff(namefile);
    ff << "Number of Triangles\tL2Error\tH1Error\th" << endl;
    for(int i = 0; i < n; i++){
      ff << Ntraingles[i] << "\t" << L2error[i] << "\t" << H1error[i] <<  "\t" << Msize[i]<<endl;
    }
  }